- Class: meta
  Course: LiDAR for Forest Ecology
  Lesson: Lesson_3
  Author: Zack Horve
  Type: Standard
  Organization: Purdue University
  Version: 2.4.5

- Class: text
  Output: |
    Welcome to Lesson 2 of LiDAR for Forest Ecology! In this lesson, you
    will learn how to quantify forest structural diversity using LiDAR through 
    an example ecological analysis comparing edge and core forest plots. Additionally, 
    you will use a LiDAR-derived canopy height model to create a wall-to-wall map 
    of forest structural diversity. 
    
- Class: figure
  Output: |
    Before we begin, let's first establish what forest structural diversity is 
    and why it is important. Forest structural diversity describes the complexity 
    of vegetation composition and spatial arrangement within a forest ecosystem. 
    Although long recognized as an important ecological attribute, structural 
    diversity has historically been difficult to measure at broad spatial scales. 
    Recent advances in airborne and terrestrial LiDAR enabled, quantification of 
    structural diversity at scale, allowing for greater advances in structural diversity 
    research. 

    Using LiDAR, structural diversity has been shown to underpin key ecosystem 
    functions, including productivity, nutrient cycling, and the support 
    of forest biodiversity through habitat provisioning. As a result, monitoring 
    structural diversity at scale has been recognized as essential for 
    informing forest management and promoting ecosystem resilience and functioning.
    
  Figure: draw_SD_fig.R
  FigureType: new
    

- Class: text
  Output: |
    To illustrate how forest structural diversity can be quantified using LiDAR, 
    we begin with an example analysis examining the effects of forest fragmentation. 
    Forest fragmentation breaks continuous forest landscapes into smaller, isolated 
    patches, creating contrasting environmental conditions between forest edges 
    and interior areas. In this first exercise, we will use airborne LiDAR to 
    evaluate how these edge effects influence forest structural diversity by 
    comparing edge and core forest plots around Lafayette, Indiana.
    
- Class: figure
  Output: |
    In total, there are 20 total plots with 15 meter radii. Ten plots are located
    in core forests (> 30 meters from nearest edge) and ten plots are located
    on forest edges adjacent to agricultural land use. Note that the sample size
    is extremely limited-- in a real ecological analysis, a larger sample size would be 
    required.
  
  Figure: draw_plots_fig.R
  FigureType: new

- Class: cmd_question
  Output: |
    Let's start by reading in our plot shapefile. Please enter the following into 
    your terminal: 
    
    plots = st_read("Data/plot_polys.shp")
    
  CorrectAnswer: plots = st_read("Data/plot_polys.shp")
  AnswerTests: omnitest(correctExpr='plots = st_read("Data/plot_polys.shp")')
  Hint: |
    Simply copy and paste the following into the terminal: 
    
    plots = st_read("Data/plot_polys.shp")

- Class: text
  Output: |
    For this lesson, LiDAR point clouds from the USGS 3D Elevation Program (3DEP) 
    have been downloaded and clipped to a buffer around our plots. Rather than 
    reading and processing each file individually, we process the data in batches. 
    This is done using a LAScatalog from the lidR package, which represents a 
    collection of LiDAR files without loading all of them into memory. Using a 
    LAScatalog allows us to efficiently compute metrics for all plots in our plot 
    shapefile, making it practical to work with large LiDAR datasets with multiple
    .las files.
    
- Class: cmd_question
  Output: |
    Let's read in our LiDAR data using a LAScatalog. Please enter the following 
    into your console: 
    
    ctg = readLAScatalog("Data/LAS")
    
  CorrectAnswer: ctg = readLAScatalog("Data/LAS"))
  AnswerTests: omnitest(correctExpr='ctg = readLAScatalog("Data/LAS")')
  Hint: |
    Simply copy and paste the following into the terminal: 
    
    ctg = readLAScatalog("Data/LAS")

- Class: cmd_question
  Output: |
    And now let's check our data out. Please enter the following into your console: 
    
    ctg
    
  CorrectAnswer: ctg
  AnswerTests: omnitest(correctExpr='ctg')
  Hint: |
    Simply copy and paste the following into the terminal: 
    
    ctg
    
- Class: mult_question
  Output: |
    How many individual LAS files are included in our LAScatalog?  
    
  AnswerChoices: 20;25;15
  CorrectAnswer: 20
  AnswerTests: omnitest(correctVal='20')
  Hint: |
    Check the num. files row in the summary output.  


- Class: text
  Output: |
    For the sake of time in this exercise, some preprocessing steps have already
    been completed. All point clouds have been normalized and have been filtered 
    to remove outlier points. In a real world example, these would be necessary steps
    before calculating any metrics at the plot level. 
    
- Class: cmd_question
  Output: |
    Now that we have our LAScatalog and plot shapefile loaded, let's try calculating 
    some metrics! Because we are interested in vegetation points (i.e. non-ground points),
    we need to first set a filter to remove points below a threshold of 0.5 meters
    to eliminate ground points. To do so, please enter the following into your console: 
    
    opt_filter(ctg) <- "-drop_z_below 0.5"

    
  CorrectAnswer: opt_filter(ctg) <- "-drop_z_below 0.5"
  AnswerTests: omnitest(correctExpr='opt_filter(ctg) <- "-drop_z_below 0.5"')
  Hint: |
    Simply copy and paste the following into the console: 
    
    opt_filter(ctg) <- "-drop_z_below 0.5"
    
- Class: cmd_question
  Output: |
    Next, we will use a function built into the lidR package to calculate a suite 
    of basic structural metrics for each plot. These metrics rely on the distribution
    of point heights within the point cloud clipped to each plot polygon. Please
    enter the following into your console: 
    
    standard_metrics = plot_metrics(ctg, .stdmetrics, geometry = plots)

  CorrectAnswer: standard_metrics = plot_metrics(ctg, .stdmetrics, geometry = plots)
  AnswerTests: omnitest(correctExpr='standard_metrics = plot_metrics(ctg, .stdmetrics, geometry = plots)')
  Hint: |
    Simply copy and paste the following into the console: 
    
    standard_metrics = plot_metrics(ctg, .stdmetrics, geometry = plots)
    
    
- Class: cmd_question
  Output: |
    Let's explore these metrics. Please enter the following into your console: 
    
    View(standard_metrics)

  CorrectAnswer: View(standard_metrics)
  AnswerTests: omnitest(correctExpr='View(standard_metrics)')
  Hint: |
    Simply copy and paste the following into the console: 
    
    View(standard_metrics)
    
- Class: text
  Output: |
    This suite of basic point cloud metrics summarizes the vertical distribution 
    of LiDAR returns within each plot. Collectively, these metrics describe key 
    properties of vegetation height, including the maximum height (zmax), mean 
    height (zmean), and various distributional metrics including height of different 
    quartiles. Because the point clouds have been filtered to non-ground returns in 
    forested areas, these statistics can be interpreted as characterizing the 
    distribution of vegetation heights within each plot, providing  a foundational 
    description of forest vertical structure. 
    
    
    
    